<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agenda Digital - Almacén</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="pagina-ingreso">

  <!-- Barra superior -->
  <div class="nav">
    <h1>📓 Agenda del Almacén</h1>
  </div>

  <!-- Contenedor principal -->
  <main class="contenedor">
    <h2 class="titulo">Agregar nueva tarea</h2>

    <form id="formTarea" class="formulario">
      <label>Título de la tarea</label>
      <input type="text" id="tarea" placeholder="Ejemplo: Enviar informe mensual" required>

      <div class="fila">
        <div class="columna">
          <label>Frecuencia</label>
          <select id="frecuencia">
            <option>Diaria</option>
            <option>Semanal</option>
            <option>Mensual</option>
          </select>
        </div>
        <div class="columna">
          <label>Fecha límite</label>
          <input type="date" id="fechaLimite" required>
        </div>
      </div>

      <label>Estado</label>
      <select id="estado">
        <option>Pendiente</option>
        <option>En progreso</option>
        <option>Completada</option>
      </select>

      <label>Correo electrónico para recordatorio</label>
      <input type="email" id="correo" placeholder="ejemplo@correo.com" required>

      <button type="submit" class="btn-principal">💾 Guardar tarea</button>
    </form>

    <h2 class="titulo subtitulo">Mis Tareas</h2>
    <div id="listaTareas" class="lista-tareas"></div>
  </main>

  <!-- Footer -->
  <footer style="background-color:#f3f4f7; padding:12px; text-align:center; font-size:12px; color:#888;">
    © 2025 Agenda del Almacén | Aguadas, Caldas
  </footer>

  <!-- Script de conexión -->
  <script>
    // 🔗 URL del Apps Script (coloca aquí tu URL)
    const scriptURL = "https://script.google.com/macros/s/AKfycbw5aEffkhdNuYGT3QlTGP5MesKOCJvIPoPQedBVDaCSXmDD-g2Ol7Wv75Z-PsnzsDGCrQ/exec";

    const form = document.getElementById('formTarea');
    const lista = document.getElementById('listaTareas');

    // Guardar nueva tarea
    form.addEventListener('submit', e => {
      e.preventDefault();

      const datos = {
        tarea: document.getElementById('tarea').value,
        frecuencia: document.getElementById('frecuencia').value,
        fechaLimite: document.getElementById('fechaLimite').value,
        estado: document.getElementById('estado').value,
        correo: document.getElementById('correo').value
      };

      fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify(datos)
      })
      .then(res => res.json())
      .then(data => {
        if (data.resultado === "ok") {
          alert('✅ Tarea guardada correctamente');
          form.reset();
          cargarTareas();
        } else {
          alert('⚠️ Error: ' + data.mensaje);
        }
      })
      .catch(err => alert('❌ Error de conexión: ' + err.message));
    });

    // Obtener tareas desde Google Sheets
    async function cargarTareas() {
      lista.innerHTML = `<p class="vacio">⏳ Cargando tareas...</p>`;
      try {
        const res = await fetch(scriptURL + '?read=true');
        const data = await res.json();

        if (!data || data.length === 0) {
          lista.innerHTML = `<p class='vacio'>No hay tareas aún.</p>`;
          return;
        }

        lista.innerHTML = '';
        data.forEach((t) => {
          const card = document.createElement('div');
          card.classList.add('tarjeta');
          card.innerHTML = `
            <div class="tarjeta-info">
              <h2>${t[1]}</h2>
              <p><span>Frecuencia:</span> ${t[2]}</p>
              <p><span>Fecha límite:</span> ${t[3]}</p>
              <p><span>Estado:</span> ${t[4]}</p>
              <p><span>Correo:</span> ${t[5]}</p>
            </div>
          `;
          lista.appendChild(card);
        });
      } catch (err) {
        lista.innerHTML = `<p class="vacio">❌ No se pudieron cargar las tareas.</p>`;
        console.error(err);
      }
    }

    // Cargar tareas al iniciar
    cargarTareas();
  </script>

</body>
</html>






